import{l as t,m as a,o as s,f as e,a as l,w as r,F as i,i as o,U as c,j as d,h as n,r as h,b as u,c as f,t as g,S as m}from"./index-a62d1839.js";import{_ as p}from"./qiun-data-charts.bbf5fc76.js";import{r as _}from"./uni-app.es.4388576a.js";import{a as w,_ as y,b}from"./uni-table.06e02d8e.js";import{_ as x,a as v,b as C,c as j}from"./4.2fdb72cb.js";import{_ as D}from"./_plugin-vue_export-helper.1b428a4d.js";import"./uni-cloud.es.8c8387e1.js";const F=D({mounted(){const t=document.getElementById("myCanvas").childNodes[0],a=t.getContext("2d");function s(){this.x=Math.random()*t.width,this.y=Math.random()*t.height,this.vx=2*(Math.random()-.5),this.vy=2*(Math.random()-.5),this.radius=3*Math.random(),this.opacity=Math.random()}t.width=window.innerWidth,t.height=window.innerHeight,s.prototype.draw=function(){a.beginPath(),a.arc(this.x,this.y,this.radius,0,2*Math.PI),a.fillStyle=`rgba(255,255,255, ${this.opacity})`,a.fill()};const e=[];for(let l=0;l<200;l++)e.push(new s);!function s(){a.clearRect(0,0,t.width,t.height),e.forEach(((s,l)=>{s.draw(),s.x+=s.vx,s.y+=s.vy,(s.x-s.radius<0||s.x+s.radius>t.width)&&(s.vx=-s.vx),(s.y-s.radius<0||s.y+s.radius>t.height)&&(s.vy=-s.vy);for(let t=l+1;t<200;t++){const l=Math.sqrt((e[t].x-s.x)**2+(e[t].y-s.y)**2);l<100&&(a.beginPath(),a.moveTo(s.x,s.y),a.lineTo(e[t].x,e[t].y),a.strokeStyle=`rgba(255,255,255,${(100-l)/100})`,a.stroke())}})),requestAnimationFrame(s)}()},data:()=>({stuList:[],causeList:[],pieArr:[],yesterdayDate:"",ChartsDate1:{},ChartsDate2:{},causeArr:{},jia:[],jian:[],opts:{color:["#00e6e6","#91CB74","#FAC858","#EE6666","#00aaff","#3CA272","#FC8452","#9A60B4","#ea7ccc","#ffff00","#ff5500"],fontColor:"#fff",padding:[15,15,0,5],enableScroll:!1,legend:{show:!1},xAxis:{boundaryGap:"justify",disableGrid:!1,min:0,axisLine:!0,max:100,fontColor:"#fff"},yAxis:{showTitle:!1},extra:{word:{type:"normal",autoColors:!0},mount:{type:"mount",widthRatio:1.5},pie:{activeOpacity:.5,activeRadius:10,offsetAngle:0,labelWidth:15,border:!0,borderWidth:3,borderColor:"#FFFFFF"},bar:{type:"group",width:15,meterBorde:1,meterFillColor:"#FFFFFF",activeBgColor:"#000000",activeBgOpacity:.08,linearType:"custom",barBorderCircle:!0,seriesGap:2,categoryGap:2,customColor:["#00aaff","#00ffff"]}}}}),onReady(){setTimeout((()=>{this.pjfChart(),this.wordChart(),this.jiajian()}),1e3),setInterval((()=>{this.wordChart()}),5e3),setInterval((()=>{window.location.reload()}),36e5)},methods:{reload(){window.location.reload()},getYesterday(){var t=(new Date).getTime()-864e5,a=new Date(t);a.getMonth(),a.getDate(),a=a.getFullYear()+"-"+(a.getMonth()>9?a.getMonth()+1:"0"+(a.getMonth()+1))+"-"+(a.getDate()>9?a.getDate():"0"+a.getDate()),this.yesterdayDate=a.toString()},getInfo(){t({url:a().globalData.baseUrl+"/findscore",method:"GET",success:t=>{this.stuList=t.data}}),t({url:a().globalData.baseUrl+"/causelist",method:"GET",success:t=>{this.causeList=t.data}})},jiajian(){let t=this.causeList,a=[],s=[];for(var e=0;e<t.length;e++)t[e].score>0?a.push(t[e]):t[e].score<0&&s.push(t[e]);let l=[],r=[];for(e=0;e<30;e++)l.push(a[e]),l[e].score=l[e].score+"分";for(e=0;e<30;e++)r.push(s[e]),r[e].score=r[e].score+"分";this.jia=l,this.jian=r},wordChart(){let t=this.causeList,a={series:[]};t=t.filter(((t,a,s)=>s.findIndex((a=>a.classs===t.classs))===a)),t.map(((t,s)=>{a.series.push(Object.assign({},{name:t.name+" "+t.cause+" "+t.score,textSize:this.getRand(12,24),data:void 0}))})),this.causeArr=a},getRand:(t,a)=>Math.floor(Math.random()*(t-a+1))+a,pjfChart(){let t={categories:[],series:[{name:"德育平均分",data:[]}]},s={categories:[],series:[{name:"德育平均分",data:[]}]},e=this.stuList,l=[];e.map(((t,a)=>{l.push(Object.assign({},{classs:t.classs,score:t.score}))}));var r=[];l.filter(((t,a,s)=>s.findIndex((a=>a.classs===t.classs))===a)).map(((t,a)=>{r.push(Object.assign({},{classs:t.classs,score:t.score}))}));let i=[];for(var o=0;o<r.length;o++){var c=l.filter((function(t){return t.classs==r[o].classs}));i.push(c)}let d=0,n=0;for(o=0;o<i.length;o++){let t=i[o];for(var h=0;h<t.length;h++)d+=t[h].score,n=(d/i[o].length).toFixed(2);d=0,r[o].score=n}r=r.sort(((t,a)=>a.score-t.score));for(o=0;o<r.length;o++)r[o].classs.includes(a().globalData.dayi)?(t.categories.push(r[o].classs),t.series[0].data.push(r[o].score)):r[o].classs.includes(a().globalData.daer)&&(s.categories.push(r[o].classs),s.series[0].data.push(r[o].score));this.ChartsDate1=t,this.ChartsDate2=s}},onLoad(){this.getYesterday(),t({url:a().globalData.baseUrl+"/findscore",method:"GET",success:t=>{this.stuList=t.data}}),t({url:a().globalData.baseUrl+"/causelist",method:"GET",success:t=>{for(var a=0;a<t.data.length;a++)t.data[a].score>0&&(t.data[a].score="+"+t.data[a].score);this.causeList=t.data}})}},[["render",function(t,a,D,F,M,L){const T=o,A=_(h("qiun-data-charts"),p),k=_(h("uni-td"),w),E=m,G=_(h("uni-tr"),y),I=_(h("uni-table"),b),B=u,R=c;return s(),e(i,null,[l(T,{class:"box"},{default:r((()=>[l(T,{class:"title",onClick:L.reload},{default:r((()=>[d(" 信息工程学院德育分系统大屏 ")])),_:1},8,["onClick"]),l(T,{class:"center"},{default:r((()=>[l(T,{class:"item"},{default:r((()=>[l(T,{class:"items"},{default:r((()=>[l(T,{class:"chartit"},{default:r((()=>[d(" 大一德育平均分 ")])),_:1}),l(T,{class:"charts-box"},{default:r((()=>[l(T,{class:"chart"},{default:r((()=>[l(A,{type:"bar",opts:M.opts,chartData:M.ChartsDate1},null,8,["opts","chartData"])])),_:1})])),_:1})])),_:1}),l(T,{class:"items"},{default:r((()=>[l(T,{class:"chartit"},{default:r((()=>[d("近期加分信息")])),_:1}),l(T,{class:"charts-box"},{default:r((()=>[l(T,{class:"chart1"},{default:r((()=>[l(T,{class:"flowjia",style:{background:"rgba(255, 255, 255,0)"}},{default:r((()=>[l(I,{border:"",stripe:"",emptyText:"查不到信息,请联系秘书部!",class:"table",style:{width:"100vw"}},{default:r((()=>[(s(!0),e(i,null,n(M.jia,((t,a)=>(s(),f(G,{key:t.id},{default:r((()=>[l(k,{align:"center",style:{width:"7vw"}},{default:r((()=>[d(g(t.classs),1)])),_:2},1024),l(k,{align:"center",style:{width:"7vw"}},{default:r((()=>[d(g(t.name),1)])),_:2},1024),l(k,{align:"center",style:{width:"10vw"}},{default:r((()=>[l(E,{"scroll-x":"true","show-scrollbar":"false",width:"10vw"},{default:r((()=>[l(T,null,{default:r((()=>[d(g(t.cause),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),l(k,{align:"center",id:"green",style:{"font-size":"16px","font-weight":"700",width:"5vw"}},{default:r((()=>[d(g(t.score),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),l(T,{class:"item"},{default:r((()=>[l(T,{class:"items1"},{default:r((()=>[l(T,{class:"charts-box1",style:{background:"rgba(255, 255, 255,0)"}},{default:r((()=>[l(A,{type:"word",opts:M.opts,chartData:M.causeArr,background:"rgba(255, 255, 255,0)"},null,8,["opts","chartData"])])),_:1})])),_:1}),l(T,{class:"items"},{default:r((()=>[l(T,{class:"chartit"},{default:r((()=>[d(" 信息工程学院德育考核标准 ")])),_:1}),l(T,{class:"charts-box"},{default:r((()=>[l(T,{class:"chart1"},{default:r((()=>[l(T,{class:"pic"},{default:r((()=>[l(T,{class:""},{default:r((()=>[l(B,{src:x,mode:"widthFix"})])),_:1}),l(T,{class:""},{default:r((()=>[l(B,{src:v,mode:"widthFix"})])),_:1}),l(T,{class:""},{default:r((()=>[l(B,{src:C,mode:"widthFix"})])),_:1}),l(T,{class:""},{default:r((()=>[l(B,{src:j,mode:"widthFix"})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),l(T,{class:"item"},{default:r((()=>[l(T,{class:"items"},{default:r((()=>[l(T,{class:"chartit"},{default:r((()=>[d(" 大二德育平均分 ")])),_:1}),l(T,{class:"charts-box"},{default:r((()=>[l(T,{class:"chart"},{default:r((()=>[l(A,{type:"bar",opts:M.opts,chartData:M.ChartsDate2},null,8,["opts","chartData"])])),_:1})])),_:1})])),_:1}),l(T,{class:"items"},{default:r((()=>[l(T,{class:"chartit"},{default:r((()=>[d("近期减分信息")])),_:1}),l(T,{class:"charts-box"},{default:r((()=>[l(T,{class:"chart1"},{default:r((()=>[l(T,{class:"flowjian"},{default:r((()=>[l(I,{border:"",stripe:"",emptyText:"查不到信息,请联系秘书部!",class:"table",style:{width:"100vw"}},{default:r((()=>[(s(!0),e(i,null,n(M.jian,((t,a)=>(s(),f(G,{key:t.id},{default:r((()=>[l(k,{align:"center",style:{width:"7vw"}},{default:r((()=>[d(g(t.classs),1)])),_:2},1024),l(k,{align:"center",style:{width:"7vw"}},{default:r((()=>[d(g(t.name),1)])),_:2},1024),l(k,{align:"center",style:{width:"10vw"}},{default:r((()=>[l(E,{"scroll-x":"true","show-scrollbar":"false"},{default:r((()=>[l(T,null,{default:r((()=>[d(g(t.cause),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),l(k,{align:"center",id:"red",style:{"font-size":"16px","font-weight":"700",width:"5vw"}},{default:r((()=>[d(g(t.score),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),l(T,{class:"footer"},{default:r((()=>[d(" imCYL ")])),_:1})])),_:1}),l(R,{id:"myCanvas",style:{}})],64)}],["__scopeId","data-v-71902a9f"]]);export{F as default};
